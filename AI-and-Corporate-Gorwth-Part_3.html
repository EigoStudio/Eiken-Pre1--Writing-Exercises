<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Eiken Pre-1st: AI & Corporate Growth - Part 3 Unemployment & Cost</title>
<style>
    :root {
        --primary-green: #2d5a27; 
        --soft-green: #e8f5e9;
        --silver-gray: #f5f5f7;
        --border-gray: #cfd8dc;
        --accent-silver: #90a4ae;
        --correct-green: #2e7d32;
        --wrong-red: #c62828;
        --text-dark: #1a3318;
        --base-font: "Hiragino Maru Gothic ProN", "Hiragino Maru Gothic Pro", "Yu Gothic", "Meiryo", sans-serif;
    }

    body {
        font-family: var(--base-font);
        background-color: var(--silver-gray);
        color: var(--text-dark);
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
        margin: 0;
    }

    header { text-align: center; margin-bottom: 20px; width: 100%; max-width: 900px; }
    h1 { font-size: 1.5rem; margin-bottom: 5px; color: var(--primary-green); }
    .sub-title { font-size: 0.85rem; color: #555; margin-bottom: 15px; font-weight: normal; }

    .control-panel {
        display: flex; align-items: center; justify-content: center; gap: 20px;
        background: rgba(255,255,255,0.8); padding: 8px 20px; border-radius: 50px; border: 1px solid var(--border-gray);
    }

    .settings { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; font-weight: bold; }
    .switch { position: relative; display: inline-block; width: 34px; height: 18px; }
    .switch input { opacity: 0; width: 0; height: 0; }
    .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 20px; }
    .slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 2px; bottom: 2px; background-color: white; transition: .4s; border-radius: 50%; }
    input:checked + .slider { background-color: var(--primary-green); }
    input:checked + .slider:before { transform: translateX(16px); }

    .tabs { display: flex; gap: 8px; }
    .tab-btn {
        padding: 6px 15px; border-radius: 20px; border: 2px solid var(--primary-green);
        background: white; color: var(--primary-green); cursor: pointer; font-weight: bold; font-size: 0.85rem; transition: 0.3s;
    }
    .tab-btn.active { background: var(--primary-green); color: white; }

    .container {
        background: white; max-width: 900px; width: 100%; padding: 30px; border-radius: 25px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.05); text-align: center;
    }

    .question-box {
        font-size: 1rem; background-color: var(--soft-green); border-bottom: 4px solid var(--primary-green);
        padding: 20px; border-radius: 15px; margin-bottom: 20px; font-weight: bold; min-height: 40px; display: flex; align-items: center; justify-content: center;
    }

    .choices-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; max-width: 700px; margin: 0 auto; }
    
    /* Vocabularyモードのボタン文字色を黒に固定 */
    .choice-btn {
        background-color: var(--soft-green); color: #000; border: 1px solid var(--border-gray);
        padding: 12px 15px; border-radius: 15px; cursor: pointer; font-size: 0.95rem; font-family: var(--base-font); font-weight: bold; transition: all 0.2s;
    }
    .choice-btn:hover { background-color: #dcedc8; }
    
    /* Sentencesモードの単語ボタン文字色を黒に固定 */
    .word-btn {
        background-color: var(--soft-green); color: #000; border: 1px solid var(--border-gray);
        padding: 12px 15px; border-radius: 15px; cursor: pointer; font-size: 0.95rem; font-family: var(--base-font); font-weight: bold; transition: all 0.2s;
    }
    .word-bank { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; margin-top: 15px; }
    .word-btn.used { visibility: hidden; pointer-events: none; }

    .answer-area {
        min-height: 80px; border: 2px dashed var(--accent-silver); border-radius: 15px; padding: 15px;
        margin-bottom: 15px; display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; background: #fafafa;
    }

    /* 並び替え後のバブル文字色を黒に固定 */
    .answer-word {
        background-color: white; color: #000; border: 1.5px solid var(--primary-green);
        padding: 8px 15px; border-radius: 10px; cursor: grab; font-size: 0.95rem; font-weight: bold;
        user-select: none;
    }

    .final-sentence {
        font-size: 1.3rem; color: var(--primary-green); font-weight: bold; padding: 20px;
        line-height: 1.6; text-align: left; background: #f1f8e9; border-radius: 15px;
    }

    .action-btn {
        background: var(--primary-green); color: white; border: none; padding: 15px 40px;
        border-radius: 30px; font-size: 1rem; font-weight: bold; cursor: pointer; margin-top: 10px;
    }
    .action-btn:disabled { background: #ccc; }

    #print-area { display: none; }

    @media print {
        .container, header, .no-print, .control-panel, .action-btn { display: none !important; }
        #print-area { 
            display: block !important; 
            color: black; 
            background: white; 
            width: 100%; 
            font-family: var(--base-font); 
        }
        .print-page { page-break-after: always; padding: 20px 40px; }
        .print-title { font-size: 1.3rem; text-align: center; border-bottom: 2px solid #000; margin-bottom: 10px; padding-bottom: 5px; }
        .print-vocab-q { margin-bottom: 8px; font-size: 0.85rem; display: flex; align-items: flex-end; }
        .vocab-jp { width: 45%; }
        .vocab-line { flex-grow: 1; border-bottom: 1px solid #000; height: 45px; }
        .print-sentence-q { margin-bottom: 22px; }
        .sentence-ja { font-size: 1rem; font-weight: bold; margin-bottom: 2px; }
        .sentence-choices { font-style: italic; font-size: 1rem; color: #333; }
        .sentence-line { border-bottom: 1px solid #000; height: 30px; margin-top: 5px; }
    }
</style>
</head>
<body>

<header class="no-print">
    <h1>英検準1級 AI & Corporate Growth - Part 3 Unemployment & Cost</h1>
    <div class="sub-title">Should companies rely more on AI to perform tasks currently done by humans?</div>
    
    <div class="control-panel">
        <div class="settings">
            <span>Audio</span>
            <label class="switch">
                <input type="checkbox" id="audioToggle" checked>
                <span class="slider"></span>
            </label>
        </div>
        <div class="tabs">
            <button class="tab-btn active" id="tab-vocab" onclick="switchMode('vocab')">Vocabulary</button>
            <button class="tab-btn" id="tab-reorder" onclick="switchMode('reorder')">Sentences</button>
        </div>
    </div>
</header>

<div class="container no-print">
    <div id="quiz-ui">
        <div class="question-box" id="questionText">Loading...</div>
        <div id="interactive-area"></div>
        <div id="resultMsg" style="margin: 15px 0; font-size: 1.1rem; font-weight: bold;"></div>
        <button class="action-btn" id="mainActionBtn" onclick="handleMainAction()" disabled>Check Answer</button>
    </div>
    <button onclick="window.print()" style="margin-top:20px; background:none; border:none; text-decoration:underline; cursor:pointer; color:#777; font-size: 0.7rem;">ワークシートを印刷する（A4）</button>
</div>

<div id="print-area">
    <div class="print-page">
        <div class="print-title">AI & Corporate Growth - Part 3 - Unemployment & Cost</div>
        <div id="print-vocab-content"></div>
    </div>
    <div class="print-page">
        <div class="print-title">Writing Exercise (Counter-arguments)</div>
        <div id="print-sentence-content"></div>
    </div>
</div>

<script>
const vocabDataRaw = [
    { en: "widespread job displacement", jp: "広範囲にわたる職の喪失" },
    { en: "threaten job security", jp: "雇用の安定を脅かす" },
    { en: "stagnant wage growth", jp: "賃金の伸び悩み" },
    { en: "digital divide", jp: "情報格差（デジタル・デバイド）" },
    { en: "reliance on automation", jp: "自動化への依存" },
    { en: "expensive maintenance fees", jp: "高額なメンテナンス費用" },
    { en: "unforeseen technical issues", jp: "予期せぬ技術的トラブル" },
    { en: "cybersecurity vulnerabilities", jp: "サイバーセキュリティの脆弱性" },
    { en: "regular system updates", jp: "定期的なシステムアップデート" },
    { en: "significant initial investment", jp: "多額の初期投資" },
    { en: "employee retraining costs", jp: "従業員の再教育コスト" },
    { en: "widening income inequality", jp: "拡大する所得格差" },
    { en: "loss of human touch", jp: "人間味の喪失" },
    { en: "technical malfunctions", jp: "技術的な故障・不具合" },
    { en: "legal and ethical liabilities", jp: "法的・倫理的な責任" },
    { en: "potential for bias", jp: "バイアス（偏り）の可能性" },
    { en: "hidden operational costs", jp: "隠れた運用コスト" },
    { en: "social instability", jp: "社会的な不安定さ" },
    { en: "decline in morale", jp: "士気の低下" }
];

const sentenceData = [
    { ja: "AIの普及は広範囲にわたる職の喪失を引き起こし、雇用の安定を脅かす可能性があります。", en: "The spread of AI may cause widespread job displacement and threaten job security." },
    { ja: "自動化への過度な依存は、労働者のスキルの低下を招くかもしれません。", en: "Excessive reliance on automation might lead to a decline in workers' skills." },
    { ja: "初期投資に加えて、企業は高額なメンテナンス費用に直面することになります。", en: "In addition to the initial investment, companies will face expensive maintenance fees." },
    { ja: "AIを導入する際、従業員の再教育コストは無視できない大きな負担となります。", en: "When implementing AI, employee retraining costs become a significant burden that cannot be ignored." },
    { ja: "技術的な不具合は、予期せぬ業務の停止と経済的損失を招く恐れがあります。", en: "Technical malfunctions risk causing unforeseen business interruptions and financial losses." },
    { ja: "AIによる自動化は、一部の専門職を除いて賃金の伸び悩みをもたらすかもしれません。", en: "Automation by AI might result in stagnant wage growth except for some specialized professions." },
    { ja: "所得格差の拡大は、深刻な社会的不安につながる懸念があります。", en: "There are concerns that widening income inequality could lead to serious social instability." },
    { ja: "サイバーセキュリティの脆弱性に対処するためには、継続的な投資が必要です。", en: "Continuous investment is required to address cybersecurity vulnerabilities." },
    { ja: "AIが生成するバイアスの可能性は、企業にとって法的な責任問題になり得ます。", en: "The potential for bias generated by AI can become a legal liability issue for companies." },
    { ja: "結論として、AIへの過度な依存は経済的・社会的なリスクを伴います。", en: "In conclusion, over-reliance on AI carries significant economic and social risks." }
];

let vocabData = [];
let currentMode = 'vocab';
let currentIdx = 0;
let userSentence = [];
let isChecked = false;
let tries = 3;

function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

function switchMode(mode) {
    currentMode = mode;
    currentIdx = 0;
    if(mode === 'vocab') {
        vocabData = [...vocabDataRaw];
        shuffleArray(vocabData);
    }
    document.getElementById('tab-vocab').classList.toggle('active', mode === 'vocab');
    document.getElementById('tab-reorder').classList.toggle('active', mode === 'reorder');
    loadQuestion();
}

function speak(text) {
    if (!document.getElementById('audioToggle').checked) return;
    const uttr = new SpeechSynthesisUtterance(text);
    uttr.lang = "en-US";
    uttr.rate = 0.9;
    window.speechSynthesis.cancel();
    window.speechSynthesis.speak(uttr);
}

function loadQuestion() {
    isChecked = false;
    tries = 3;
    document.getElementById('resultMsg').textContent = "";
    const btn = document.getElementById('mainActionBtn');
    btn.textContent = "Check Answer";
    btn.disabled = true;

    const area = document.getElementById('interactive-area');
    area.innerHTML = "";

    if (currentMode === 'vocab') {
        const item = vocabData[currentIdx];
        document.getElementById('questionText').textContent = item.jp;
        let choices = [item.en];
        while(choices.length < 4) {
            let r = vocabDataRaw[Math.floor(Math.random()*vocabDataRaw.length)].en;
            if(!choices.includes(r)) choices.push(r);
        }
        shuffleArray(choices);
        
        const grid = document.createElement('div');
        grid.className = "choices-grid";
        choices.forEach(c => {
            const b = document.createElement('button');
            b.className = "choice-btn";
            b.textContent = c;
            b.onclick = () => {
                if(isChecked) return;
                selectedWord = c;
                document.querySelectorAll('.choice-btn').forEach(btn => btn.style.backgroundColor = "var(--soft-green)");
                b.style.backgroundColor = "#dcedc8";
                btn.disabled = false;
                speak(c);
            };
            grid.appendChild(b);
        });
        area.appendChild(grid);
    } else {
        const item = sentenceData[currentIdx];
        document.getElementById('questionText').textContent = item.ja;
        userSentence = [];
        
        const ansArea = document.createElement('div');
        ansArea.className = "answer-area";
        ansArea.id = "answerArea";
        ansArea.addEventListener('dragover', e => e.preventDefault());
        area.appendChild(ansArea);

        const bank = document.createElement('div');
        bank.className = "word-bank";
        
        let words = item.en.replace(/([.,])/g, " $1").split(" ").filter(w => w !== "");
        let shuffleWords = [...words];
        shuffleArray(shuffleWords);

        shuffleWords.forEach((w, idx) => {
            const b = document.createElement('button');
            b.className = "word-btn";
            b.textContent = w;
            b.id = "word-" + idx;
            b.onclick = () => {
                userSentence.push({text: w, btnId: b.id});
                b.classList.add('used');
                renderSentence();
                btn.disabled = false;
            };
            bank.appendChild(b);
        });
        area.appendChild(bank);
        renderSentence();
    }
}

function renderSentence() {
    const area = document.getElementById('answerArea');
    area.innerHTML = "";
    userSentence.forEach((obj, i) => {
        const s = document.createElement('div');
        s.className = "answer-word";
        s.textContent = obj.text;
        s.draggable = true;
        s.addEventListener('dragstart', (e) => e.dataTransfer.setData('text/plain', i));
        s.addEventListener('drop', (e) => {
            e.preventDefault();
            const fromIndex = parseInt(e.dataTransfer.getData('text/plain'));
            const movedItem = userSentence.splice(fromIndex, 1)[0];
            userSentence.splice(i, 0, movedItem);
            renderSentence();
        });
        s.onclick = () => {
            document.getElementById(obj.btnId).classList.remove('used');
            userSentence.splice(i, 1);
            renderSentence();
        };
        area.appendChild(s);
    });
}

function handleMainAction() {
    const btn = document.getElementById('mainActionBtn');
    const resultMsg = document.getElementById('resultMsg');

    if (!isChecked) {
        let correctText = currentMode === 'vocab' ? vocabData[currentIdx].en : sentenceData[currentIdx].en;
        let isCorrect = false;

        if (currentMode === 'vocab') {
            isCorrect = (selectedWord === correctText);
        } else {
            let userStr = userSentence.map(o => o.text).join(" ").replace(/\s+([.,])/g, "$1");
            isCorrect = (userStr === correctText);
        }

        if (isCorrect) {
            isChecked = true;
            speak(correctText);
            document.getElementById('interactive-area').innerHTML = `<div class="final-sentence">${correctText}</div>`;
            resultMsg.innerHTML = "Perfect! ✨";
            btn.textContent = "Next →";
        } else {
            tries--;
            if (tries > 0) {
                resultMsg.innerHTML = "Not quite... Try again!";
                resultMsg.style.color = "var(--wrong-red)";
            } else {
                isChecked = true;
                resultMsg.innerHTML = `Answer: ${correctText}`;
                btn.textContent = "Next →";
            }
        }
    } else {
        currentIdx++;
        const max = currentMode === 'vocab' ? vocabData.length : sentenceData.length;
        if (currentIdx < max) loadQuestion();
        else {
            document.getElementById('quiz-ui').innerHTML = "<h2>Mission Accomplished!</h2><p>You are ready for the test.</p>";
            btn.style.display = "none";
        }
    }
}

function preparePrint() {
    document.getElementById('print-vocab-content').innerHTML = vocabDataRaw.map((d, i) => `
        <div class="print-vocab-q">
            <span class="vocab-jp">${i+1}. ${d.jp}</span>
            <div class="vocab-line"></div>
        </div>`).join('');

    document.getElementById('print-sentence-content').innerHTML = sentenceData.map((d, i) => {
        let words = d.en.replace(/([.,])/g, " $1").split(" ").filter(w => w !== "");
        shuffleArray(words);
        return `
            <div class="print-sentence-q">
                <div class="sentence-ja">${i+1}. ${d.ja}</div>
                <div class="sentence-choices">[ ${words.join(" / ")} ]</div>
                <div class="sentence-line"></div>
            </div>`;}).join('');
}

window.onload = () => {
    vocabData = [...vocabDataRaw];
    shuffleArray(vocabData);
    loadQuestion();
    preparePrint();
};
</script>
</body>
</html>