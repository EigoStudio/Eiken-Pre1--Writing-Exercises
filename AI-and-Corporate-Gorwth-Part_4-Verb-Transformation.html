<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Worksheet: Word Power PRO (No Choices Version)</title>
<style>
    :root {
        --primary-pink: #e91e63; --deep-purple: #6a1b9a; --accent-blue: #0288d1;
        --soft-purple: #f3e5f5; --bg-color: #fcfaff; --text-dark: #333;
        --base-font: "Hiragino Maru Gothic ProN", "Yu Gothic", sans-serif;
    }
    body { font-family: var(--base-font); background-color: var(--bg-color); color: var(--text-dark); display: flex; flex-direction: column; align-items: center; padding: 15px; margin: 0; }
    
    /* --- ブラウザ表示用デザイン --- */
    .no-print { display: block; }
    .container { background: white; max-width: 850px; width: 100%; padding: 25px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.05); text-align: center; margin-top: 15px; }
    .tabs { display: flex; gap: 8px; margin: 15px 0; }
    .tab-btn { padding: 8px 20px; border-radius: 30px; border: 2px solid var(--primary-pink); background: white; color: var(--primary-pink); cursor: pointer; font-weight: bold; font-size: 0.9rem; }
    .tab-btn.active { background: var(--primary-pink); color: white; }
    .word-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; background: var(--soft-purple); padding: 15px; border-radius: 12px; }
    .grid-header { font-weight: bold; color: var(--deep-purple); padding: 8px; font-size: 0.95rem; }
    .fixed-word { font-weight: bold; color: var(--accent-blue); background: #e3f2fd; padding: 6px; border-radius: 5px; width: 90%; display: inline-block; font-size: 0.95rem; }
    .input-field { width: 85%; padding: 6px; border: 1px solid #ccc; border-radius: 5px; text-align: center; font-size: 0.95rem; }
    .activity-card { background: #fff; border-left: 5px solid var(--primary-pink); border-radius: 8px; padding: 15px; text-align: left; margin-top: 10px; }
    .sentence-row { margin-bottom: 12px; line-height: 1.5; font-size: 0.95rem; }
    .word-select { padding: 3px; border: 2px solid var(--primary-pink); border-radius: 6px; font-weight: bold; font-size: 0.9rem; }
    .action-btn { background: var(--accent-blue); color: white; border: none; padding: 10px 30px; border-radius: 25px; font-size: 1rem; font-weight: bold; cursor: pointer; margin-top: 15px; }
    #print-area { display: none; }

    /* --- 印刷用設定 (Cmd+P) --- */
    @media print {
        @page { size: A4; margin: 10mm; }
        body { background: white; color: black; padding: 0; }
        .no-print, header, .tabs, .action-btn, .container { display: none !important; }
        
        #print-area { display: block !important; width: 100%; }
        .print-page { page-break-after: always; color: black; }
        .print-title { font-size: 1rem; font-weight: bold; border-bottom: 1px solid black; margin-bottom: 5px; text-align: center; padding-bottom: 2px; }
        
        .print-grid { display: grid; grid-template-columns: repeat(3, 1fr); border-collapse: collapse; width: 100%; margin-top: 5px; }
        .print-grid div { border: 1px solid black; padding: 5px; text-align: center; font-size: 0.95rem; min-height: 20px; }
        .print-header { background: #f0f0f0 !important; font-weight: bold; }
        .p-fixed { font-weight: bold; }
        
        .print-sentence-box { margin-bottom: 12px; padding-bottom: 6px; border-bottom: 0.5px solid #eee; }
        .print-sentence-title { font-weight: bold; font-size: 0.8rem; margin-bottom: 1px; }
        .print-sentence-row { margin-bottom: 2px; line-height: 1.3; font-size: 0.85rem; }
        .blank-line { display: inline-block; width: 120px; border-bottom: 1px solid black; margin: 0 2px; vertical-align: bottom; }
        /* Choicesは削除 */
    }
</style>
</head>
<body>

<header class="no-print">
    <h1 style="color:var(--deep-purple); font-size: 1.4rem; margin-bottom: 5px;">Word Power PRO</h1>
    <div class="tabs">
        <button class="tab-btn active" id="tab1" onclick="switchSection(1)">1. Table Puzzle</button>
        <button class="tab-btn" id="tab2" onclick="switchSection(2)">2. Sentence Quiz</button>
    </div>
</header>

<div class="container no-print" id="section1">
    <div class="word-grid" id="wordGrid">
        <div class="grid-header">Verb</div><div class="grid-header">Adjective</div><div class="grid-header">Noun</div>
    </div>
    <div id="msg1"></div>
    <button class="action-btn" onclick="checkStep1()">Check Answers</button>
</div>

<div class="container no-print" id="section2" style="display:none;">
    <h3 id="quiz-title" style="font-size: 1.1rem; margin-top: 0;"></h3>
    <div id="quiz-stack"></div>
    <div id="msg2"></div>
    <button class="action-btn" id="nextBtn" onclick="checkStep2()">Verify Answers</button>
</div>

<div id="print-area">
    <div class="print-page">
        <div class="print-title">Word Power Worksheet - 1: Transformation</div>
        <p style="font-size:0.8rem; margin:0 0 10px 0;">Fill in the missing forms based on the hint given in each row.</p>
        <div class="print-grid" id="pGrid">
            <div class="print-header">Verb</div><div class="print-header">Adjective</div><div class="print-header">Noun</div>
        </div>
    </div>
    <div class="print-page">
        <div class="print-title">Word Power Worksheet - 2: Sentences</div>
        <p style="font-size:0.8rem; margin:0 0 10px 0;">Use the correct word form for each context based on the key word in [ ].</p>
        <div id="pSentences"></div>
    </div>
</div>

<script>
const masterVocab = [
    { v: "create", a: "creative", n: "creation", s1: "AI technology can ( ) many useful tools for our daily lives.", s2: "Employees should focus on ( ) work that machines cannot do.", s3: "The ( ) of a new AI model takes a lot of time and money."},
    { v: "innovate", a: "innovative", n: "innovation", s1: "Companies need to ( ) to survive in the modern market.", s2: "The company's success is based on its ( ) ideas.", s3: "AI is expected to bring great ( ) to the medical field."},
    { v: "analyze", a: "analytical", n: "analysis", s1: "Computers can ( ) data much faster than humans can.", s2: "To solve this problem, you need to use ( ) thinking.", s3: "According to the latest ( ), AI will create more jobs in the future."},
    { v: "compete", a: "competitive", n: "competition", s1: "Japanese companies have to ( ) with businesses all over the world.", s2: "The IT industry is a very ( ) field to work in.", s3: "AI will increase ( ) among global corporations."},
    { v: "effect", a: "effective", n: "effect", s1: "New technology will ( ) many changes in our society.", s2: "Using AI is an ( ) way to save time and reduce costs.", s3: "Using AI has a positive ( ) on corporate growth."},
    { v: "rely", a: "reliable", n: "reliance", s1: "Many people ( ) on smartphones for information every day.", s2: "It is important to use ( ) information when you write an essay.", s3: "Over-( ) on AI may lead to a loss of human skills."},
    { v: "produce", a: "productive", n: "production", s1: "AI-driven robots can ( ) high-quality products very quickly.", s2: "The workers become more ( ) by using the new system.", s3: "AI is being used to increase food ( ) in many countries."},
    { v: "succeed", a: "successful", n: "success", s1: "I believe that this project will ( ) in the long run.", s2: "He is a ( ) businessman who uses AI for his work.", s3: "The ( ) of AI depends on how we use the technology."},
    { v: "predict", a: "predictable", n: "prediction", s1: "It is hard to ( ) what the world will be like in 10 years.", s2: "The result of the game was ( ) because of the data analysis.", s3: "AI makes an accurate ( ) about the future weather."},
    { v: "solve", a: "solvable", n: "solution", s1: "Humans and AI can work together to ( ) difficult problems.", s2: "With the help of AI, many social issues will become ( ).", s3: "Finding a ( ) to global warming is a major challenge."}
];

let selected10 = [];
let currentQIdx = 0;
function shuffle(arr) { return arr.sort(() => Math.random() - 0.5); }

function init() {
    selected10 = shuffle([...masterVocab]).slice(0, 10);
    const grid = document.getElementById('wordGrid');
    const pg = document.getElementById('pGrid');
    const ps = document.getElementById('pSentences');

    selected10.forEach((p, idx) => {
        const hintCol = Math.floor(Math.random() * 3);
        const types = ['v', 'a', 'n'];

        types.forEach((type, colIdx) => {
            const div = document.createElement('div');
            const pDiv = document.createElement('div');
            div.className = "cell";
            if(colIdx === hintCol) {
                div.innerHTML = `<span class="fixed-word">${p[type]}</span>`;
                pDiv.innerHTML = `<span class="p-fixed">${p[type]}</span>`;
            } else {
                div.innerHTML = `<input type="text" class="input-field" data-ans="${p[type]}" id="step1-${idx}-${type}">`;
                pDiv.textContent = ""; 
            }
            grid.appendChild(div);
            pg.appendChild(pDiv);
        });

        const pBox = document.createElement('div');
        pBox.className = "print-sentence-box";
        const quizSents = shuffle([{t:p.s1, a:p.v}, {t:p.s2, a:p.a}, {t:p.s3, a:p.n}]);
        pBox.innerHTML = `
            <div class="print-sentence-title">${idx + 1}. [ ${p.v.toUpperCase()} ]</div>
            ${quizSents.map((q, i) => `<div class="print-sentence-row">${String.fromCharCode(97+i)}) ${q.t.replace('( )', '<span class="blank-line"></span>')}</div>`).join('')}
        `;
        ps.appendChild(pBox);
    });
}

function checkStep1() {
    const inputs = document.querySelectorAll('.input-field');
    inputs.forEach(i => { i.style.backgroundColor = i.value.toLowerCase().trim() === i.dataset.ans ? "#c8e6c9" : "#ffcdd2"; });
}

function switchSection(n) {
    document.getElementById('section1').style.display = n === 1 ? 'block' : 'none';
    document.getElementById('section2').style.display = n === 2 ? 'block' : 'none';
    document.querySelectorAll('.tab-btn').forEach((b, i) => b.classList.toggle('active', i+1 === n));
    if(n === 2) { currentQIdx = 0; shuffle(selected10); loadQuiz(); }
}

function loadQuiz() {
    if(currentQIdx >= 10) return;
    const p = selected10[currentQIdx];
    document.getElementById('quiz-title').textContent = `Set ${currentQIdx + 1}/10: [ ${p.v.toUpperCase()} ]`;
    const stack = document.getElementById('quiz-stack');
    stack.innerHTML = "";
    const qs = shuffle([{txt: p.s1, ans: p.v}, {txt: p.s2, ans: p.a}, {txt: p.s3, ans: p.n}]);
    const choices = shuffle([p.v, p.a, p.n]);
    qs.forEach((q, i) => {
        const card = document.createElement('div');
        card.className = "activity-card";
        card.innerHTML = `<div class="sentence-row">${i+1}. ${q.txt.replace('( )', `<select class="word-select" id="q-${i}" data-ans="${q.ans}"><option value="">--Select--</option>${choices.map(c => `<option value="${c}">${c}</option>`).join('')}</select>`)}</div>`;
        stack.appendChild(card);
    });
}

function checkStep2() {
    let c = 0;
    for(let i=0; i<3; i++) {
        const sel = document.getElementById(`q-${i}`);
        if(sel.value === sel.dataset.ans) { sel.style.color = "green"; c++; } else sel.style.color = "red";
    }
    if(c === 3) { currentQIdx++; setTimeout(loadQuiz, 400); }
}

window.onload = init;
</script>
</body>
</html>